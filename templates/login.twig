{% extends "base.twig" %}

{% block title %}Peludors{% endblock %}
{% block head %}
    {{ parent() }}
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
{% endblock %}
{% block content %}

    <nav aria-label="breadcrumb animated slideInDown">
        <ol class="breadcrumb justify-content-center mb-0">
            <li class="breadcrumb-item"><a href="#">Home</a></li>
            <li class="breadcrumb-item"><a href="#">Pages</a></li>
            <li class="breadcrumb-item active" aria-current="page">Login</li>
        </ol>
    </nav>

    <!-- Features Start -->
    <div class="container-xxl py-5 ">

        <div class="row g-5 min-vh-50">
            <div class="text-center mx-auto wow fadeInUp" data-wow-delay="0.1s">
                <p class="section-title bg-white text-center text-primary px-3">Login</p>
            </div>
            <div class="col-lg-4" data-wow-delay="0.1s">
                <div class="d-flex justify-content-center mx-auto pt-5">
                    <div style="transform: scale(1.3); transform-origin: center;">
                        <div class="g-signin2" data-onsuccess="onSignIn"></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-8">
                <div class="rounded overflow-hidden">
                    <div class="row g-0">
                        <div class="col-sm-6 wow fadeIn" data-wow-delay="0.5s">
                            <div class="text-center bg-secondary py-5 px-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="primary-color icon-svg font-size-64" viewBox="0 0 512 512">
                                    <path d="M226.5 92.9c14.3 42.9-.3 86.2-32.6 96.8s-70.1-15.6-84.4-58.5s.3-86.2 32.6-96.8s70.1 15.6 84.4 58.5zM100.4 198.6c18.9 32.4 14.3 70.1-10.2 84.1s-59.7-.9-78.5-33.3S-2.7 179.3 21.8 165.3s59.7 .9 78.5 33.3zM69.2 401.2C121.6 259.9 214.7 224 256 224s134.4 35.9 186.8 177.2c3.6 9.7 5.2 20.1 5.2 30.5l0 1.6c0 25.8-20.9 46.7-46.7 46.7c-11.5 0-22.9-1.4-34-4.2l-88-22c-15.3-3.8-31.3-3.8-46.6 0l-88 22c-11.1 2.8-22.5 4.2-34 4.2C84.9 480 64 459.1 64 433.3l0-1.6c0-10.4 1.6-20.8 5.2-30.5zM421.8 282.7c-24.5-14-29.1-51.7-10.2-84.1s54-47.3 78.5-33.3s29.1 51.7 10.2 84.1s-54 47.3-78.5 33.3zM310.1 189.7c-32.3-10.6-46.9-53.9-32.6-96.8s52.1-69.1 84.4-58.5s46.9 53.9 32.6 96.8s-52.1 69.1-84.4 58.5z"/>
                                </svg>
                                <h1 class="display-6 py-2" data-toggle="counter-up">51940</h1>
                                <span class="fs-5 fw-semi-bold text-primary">Animales</span>
                            </div>
                        </div>
                        <div class="col-sm-6 wow fadeIn" data-wow-delay="0.7s">
                            <div class="text-center bg-primary py-5 px-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="secondary-color icon-svg font-size-64" viewBox="0 0 16 16">
                                    <path d="M9 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0m-9 8c0 1 1 1 1 1h10s1 0 1-1-1-4-6-4-6 3-6 4m13.5-8.09c1.387-1.425 4.855 1.07 0 4.277-4.854-3.207-1.387-5.702 0-4.276Z"/>
                                </svg>
                                <h1 class="display-6 py-2" data-toggle="counter-up">2619</h1>
                                <span class="fs-5 fw-semi-bold text-secondary">Usuarios Felices</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Features End -->


    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../public/lib/wow/wow.min.js"></script>
    <script src="../public/lib/easing/easing.min.js"></script>
    <script src="../public/lib/waypoints/waypoints.min.js"></script>
    <script src="../public/lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="../public/lib/counterup/counterup.min.js"></script>
    <script src="../public/lib/parallax/parallax.min.js"></script>
    <script src="../public/lib/lightbox/js/lightbox.min.js"></script>

    <!-- Template Javascript -->
    <script src="../public/js/main.js"></script>

    <script>
        /*function onSignIn(googleUser) {
            var profile = googleUser.getBasicProfile();
            //crear una solo cuando se le de al bot√≥n, probar mas
            console.log(profile);
            const sessionData = {
                userID: profile.userID,
                userName: profile.getName(),
                userEmail: profile.getEmail()
            };
            document.cookie = `peludorsToken=${encodeURIComponent(JSON.stringify(sessionData))}; path=/; max-age=${60 * 60 * 24}; secure; SameSite=Lax`;
            setTimeout(function() {
                //window.location.href = "/";
            }, 300); // (0.3 seconds)
        }*/
    </script>


    <script>
        function onSignIn(googleUser) {
            const profile = googleUser.getBasicProfile();
            const id_token = googleUser.getAuthResponse().id_token;

            const userData = {
                id_token: id_token
            };

            fetch('login/google/callback', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(userData)
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        setTimeout(function() {
                            window.location.href = "/";
                        }, 300); // (0.3 seconds)
                    } else {
                        alert('Login fallido: ' + data.message);
                    }
                })
                .catch(err => console.error('Error:', err));
        }
    </script>


{% endblock %}